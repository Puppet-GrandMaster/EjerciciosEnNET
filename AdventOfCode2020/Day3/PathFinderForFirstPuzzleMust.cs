using System;
using System.Collections.Generic;
using System.Linq;
using Xunit;

namespace Day3
{
    public class PathFinderForFirstPuzzleMust
    {
        [Fact]
        public void Test1()
        {
            var map = new string[]
            {
                "..##",
                "#..."
            };
            var path = new PathFinderForFirstPuzzle(map);

            path.Traverse(x => x + 3, y => y + 1);
            Assert.Equal(0, path.Trees);
        }

        [Fact]
        public void Test2()
        {
            var map = new string[]
            {
                "..##...",
                "#...#..",
                ".#....#"
            };
            var path = new PathFinderForFirstPuzzle(map);

            path.Traverse(x => x + 3, y => y + 1);
            Assert.Equal(1, path.Trees);
        }

        [Fact]
        public void Test21()
        {
            var map = new string[]
            {
                "..##...",
                "#...#..",
                ".#....#"
            };
            var path = new PathFinderForFirstPuzzle(map);

            path.Traverse(x => x + 1, y => y + 3);
            Assert.Equal(0, path.Trees);
        }

        [Fact]
        public void Test3()
        {
            var map = new string[]
            {
                "..##......",
                "#...#...#.",
                ".#....#..#",
                "..#.#...#."
            };
            var path = new PathFinderForFirstPuzzle(map);

            path.Traverse(x => x + 3, y => y + 1);
            Assert.Equal(1, path.Trees);
        }

        [Theory]
        [InlineData(1, 1, 2)]
        [InlineData(3, 1, 7)]
        [InlineData(5, 1, 3)]
        [InlineData(7, 1, 4)]
        [InlineData(1, 2, 2)]
        public void FindDeterminedAmountOfTrees_WhenWalkingInCertainWay(int offsetX, int offsetY, int expectedTrees)
        {
            var map = new string[]
            {
                "..##.......",
                "#...#...#..",
                ".#....#..#.",
                "..#.#...#.#",
                ".#...##..#.",
                "..#.##.....",
                ".#.#.#....#",
                ".#........#",
                "#.##...#...",
                "#...##....#",
                ".#..#...#.#"
            };
            var path = new PathFinderForFirstPuzzle(map);

            path.Traverse(x => x + offsetX, y => y + offsetY);
            Assert.Equal(expectedTrees, path.Trees);
        }

        [Fact]
        public void SolveFirstPuzzle()
        {
            var map = new string[]
            {
                "....#............#.###...#.#.#.",
                ".#.#....##.........#.....##.#..",
                ".#..#.#...####.##..#......#..##",
                "......#...#...#.......#........",
                "........#...###..#.#....#....#.",
                "..##.....#.....#.#.........#.#.",
                ".##.......#.#.#...#..#...##...#",
                "...##.....#....##....#...###.#.",
                "..#...#......##.#.##.....#.#..#",
                ".#....#.###.........#..........",
                ".#.#..##.....###.....###....#.#",
                "....###....#......#...#......##",
                "......##...#.##.........#.#..#.",
                "##.#....##...#..##....#.#..#.##",
                ".#...#..#.....#.#.......#...#..",
                "..........#..###.###......##..#",
                "..#.##.#..#......#.......###.#.",
                "...#...#.#.#..#...#.#..........",
                "#........#..#..#.#....#.##..###",
                "#...#.....#..####.........####.",
                ".....###..........#.#...##...#.",
                ".....#...#..#.......#....##.#..",
                "...........#..##.....#...#..#..",
                "......##..#........#...........",
                "#.#..#.#.#..#.....#....#.....#.",
                "..#....##....##...#.....#......",
                ".#.#....#..#.#......#..###...#.",
                ".......#...#.#....##..#..#..#..",
                ".#.#.#.......#....#.#.#.......#",
                ".#..........#.##.#...#..#.#.##.",
                "..#.#..........#.#....##.#.##..",
                "###..#..#.#...##.#.#..#........",
                "##....#...#....#....#...#.#....",
                "#...#.#....#.##..##...#.#......",
                "......#...#.###......##....#...",
                ".................#.###......#..",
                "##..#....#....##...###.#.#..###",
                "..#..........#..####..##..#...#",
                ".#......#..#.#...........##.#..",
                ".#..#......#...#.#.#..#.#.#.#.#",
                ".#......###.....#.#.#......##..",
                "#..........#.##...#...........#",
                "..#....#.##....#.........#.....",
                ".#..##....#...##.........#..#..",
                "....##..#.###..#.#...#..###..#.",
                "..#......#........#...#.#......",
                "........#..#..#..#...#.##......",
                ".##.#.#......#...#.........#...",
                "#..###.#...#....###.##..###....",
                "........##.............#....#..",
                "...#...............#....#.#....",
                "#..........#..#..#.#.....#...#.",
                ".#.............#...#.......#..#",
                ".#..#..#...#........##.........",
                ".....#.#..#.#..#..##.........#.",
                "..#..##...#....#.#...#.###..#..",
                "#...........##.....#...#.##....",
                "#.#.#.#........##......#...#.#.",
                "......#..#.###.#...#.##.##....#",
                ".#....#...#....#........#....#.",
                "..#.#..........#..##.......#..#",
                ".....#...##..#................#",
                ".#...............##...#.##...##",
                "#.####....##.....#.......#.##..",
                "......#.##.#...##..###..#.#....",
                ".#.##.#...##..#.......#.#..#...",
                "#...#.##..........##..........#",
                "#.###...#...#..#.....#.#.##..##",
                ".##.....#....#...##.....##.....",
                "...#........#..###.###...#.....",
                "##..#....#.....#...#.#....#.#..",
                "#....#....#.#..........#...#..#",
                "...##..#......#..#..#..#..#....",
                ".....##...#..####..##.........#",
                ".....#..#.#...#..#....##..##...",
                "..#.......##.#..#.##...#.#....#",
                ".#..#.#...##..##....#..#......#",
                "..##.##..##...###..#....#...#..",
                "........##.......##...##.....##",
                ".#....###...#..#..#..#.......#.",
                "#.###............#....##.....#.",
                "..........#...#...##..#...#....",
                "..#......#.##.......#....##..##",
                "..#..###.....#...#.......#.....",
                "#.#...##.....#...#....#.......#",
                "....##.##.#....#.....#.#....#..",
                "...#....#.###............#..###",
                "#..##..#.........##.....#.#...#",
                "....#.......##......#....#...#.",
                "....#..##.#..........#.........",
                "....#...#.###.......#...#.#....",
                "#..#..#...#.......##...#..#.##.",
                "#.......#...##.##......#.......",
                "##..##...##...#......#...#...##",
                "..#...#.#.####.#...##.....##...",
                "#...#..#..#...##......#.#..#..#",
                "..##..##.#.#..#...####.....###.",
                ".#........#..##.###...#.##.#...",
                "........#..#...##......#.#....#",
                "..#...###.......##..##..#....#.",
                ".##...#.#..#.##.......##.###...",
                "#....#.#.#........#....#..#.##.",
                "....#.##.#.##..#.#####.....###.",
                "#.#..#..#...#.#..#.......#.#...",
                "....#...#....###...............",
                ".###.#.....#.#.......###......#",
                "##...#.#.###....##..#...##.....",
                "...#.#..#.###.#.......#...#.#..",
                ".#...#....#...#..####....###...",
                "..#....##.....##.#.#.##....#...",
                "#....#..##.......#...##.##....#",
                ".##..#.......#..#....###.......",
                "#.##.....##.#.........#......##",
                ".####.#...#.....#..#...#.##..#.",
                "....#...........#.....#........",
                ".#............##...#.......#.#.",
                "#....#.##........#....#.#..#..#",
                "#....#.##....#...##...#..#..#..",
                "...#..#.####.#....#............",
                "....#......#.........#.........",
                "#....##....###.....#......#.#..",
                "...#..#....#........###..#...#.",
                "..#.#........#.#.#.###..#.#.#..",
                ".....###.....##.#....###.#.....",
                "##.#....#....##...##.###.#.##..",
                ".###.#..#.......##...#...##....",
                ".#...###........#.......##.##..",
                "#......####...#...##.#.######..",
                "....##.............#..##.##...#",
                "...........#..##.#...#.#.#...#.",
                "###.......#.##..#....#...#....#",
                ".........#.....#.#.#..##.#.....",
                "#...##..#....#..#.............#",
                "...#.......#.##.............#.#",
                ".....#..#...##......####..#....",
                ".#.#.#.....#...####..#...##...#",
                "#...#.#..#..#.#..#.##..........",
                ".....#.##..#.#.##..#.#.#....#.#",
                "...##..#...#...#..#....#.......",
                "........#.#..#...#...#.#...#...",
                "##..#........#..#.....#......##",
                ".........#..#...#......#......#",
                "..#.#.#........##...#.##.....##",
                ".###....##....#...#....#..#....",
                ".#.............###...#..##..###",
                ".##.##.##.......###.........#.#",
                "..#..###...#...#....#..#.#..#.#",
                "......#..#.#..#.....#.#........",
                "......#...####...#.#.....#.....",
                ".#...##.......#..#......#...#..",
                "#..#...#.......###..#..#.#.#.#.",
                ".....#.....###.##....#.#.##.#.#",
                "#........#....##...#..#.##..#..",
                "...#.#........##....#.#..###.#.",
                "#...#...##.........#........###",
                "##...#.##..##...#.....#.###.#..",
                "#.###.#.#..#...........##..#...",
                "........#.......#..#..#.###....",
                "#........#....#......###.......",
                "..#.###.######...#.###..#......",
                "...#...######..#.....#....#.#..",
                "..#.......#..#..#.........#...#",
                ".#...#..##.##.........##.......",
                ".........#.#.##.#..#....#.#...#",
                "#.......#....#......#.....###.#",
                "##..............#.###........#.",
                "..#.##..#.##.....#...#.#.#..###",
                "..#.#......#..#..##.#........#.",
                "..#.....#...#.#...#...###..#.#.",
                ".......#...........#..#..#.#.##",
                ".......#...##..#.###...........",
                ".#........#.###.#..#..#..#..#..",
                "##.#.##....#..###..#.##.##...#.",
                ".....#....##.#........#.#.#....",
                "....##....#..#..#....##....#.#.",
                "#.....##....#.....#.###.#....#.",
                ".#.##.##..#..#...#...........##",
                "...#..###..#.....##....#.......",
                "...#..##..###.#..#..#.#........",
                "......##..#.......#..##.....###",
                ".#...##.#.#.#......#...#.#.#.##",
                "....#.#....#...#........#...#..",
                "....#.#......#.#.###.#.#.##.#..",
                "#..#........###..#..#..#.....#.",
                "...#....#...##...#........##.##",
                ".....#..#..#.....#....#.#...#..",
                "..#.###....#.#..##......#.##.#.",
                "..####......#..#.#.#..#.#####..",
                ".......##..#..###.#............",
                "..###.#........#..........##.##",
                "#.#.........#.##.#......#..#...",
                "...#.....#.....##..#..##.##..#.",
                "#.#.##....#.......###....##....",
                "...##.#..#...##.#..#......#..#.",
                "..##.........#.##.#####...#.#..",
                ".#....#...#....#.#.....##...###",
                "##.....#..####............###.#",
                "......#...........#....#.......",
                ".#......#.....##...........###.",
                "#......##.......#.#.#..##.....#",
                "...###.#.....##.#...#.#....#.#.",
                "...###.......#...#.............",
                "..#..#.#....#.#.###.#.#.##..##.",
                "..##...#..#.#..##.#.##....##...",
                "..#...........#..#....#....#...",
                "#.##...........#..#.#..##.#.#..",
                "...##...##................#..#.",
                ".#...#.##......#.#......#.####.",
                "#.##....#....#.........#....###",
                ".....###........#.#.#.##...#.##",
                ".....#....#.#....#.........#..#",
                "..#...#.#.#.#...#...#...##.#..#",
                "###.......#.....#.............#",
                "#.####.#.......#.#.#.#..#.#....",
                "#..#..#####......#....#..##....",
                "...............#.....#.#....###",
                ".###.....#...#.##..#.#..#.#####",
                "#.##.....#......##.......##....",
                "..........###.......#...#.#....",
                "..#.#..#...##.....#........#.#.",
                "........##.##....#####.#.#..##.",
                "..##.#.#...#####..........#.#.#",
                "#.........#......##...#.....#..",
                ".##.#........#...#..##...#...#.",
                ".......##..#...#.....#.##......",
                "....#.#...##..##..#....##......",
                "#........#..........##..####.#.",
                "...###...#.#.###.#...#....#.#.#",
                ".....##.#.....#........#.#....#",
                "#.......#....#...##..#......#..",
                "...#..........#.#.#...#.#.###.#",
                "....##.....#.##..#.#.#.........",
                "#.##..##..#....#.........#...#.",
                ".###..........#...##.#..#......",
                ".....####.............##...###.",
                ".#..#....#..#...#..#...........",
                "#..#..##..#...#.##..#.###.#...#",
                "......#.#..###...#..#.....#..#.",
                "##.##......#...#.#...#.........",
                "....##.#.......#.#..##....#.#.#",
                "#..##..#...###.#....##.........",
                ".............#.#....#...##..#..",
                "..#....#...#.....#.##.#..##..##",
                "##.#..##.#..##.#.#.##.#...#.#..",
                ".##.#..#.#........##.#...##....",
                "#.........##....##..#......#...",
                ".#.#.......##...#..#......###.#",
                "........#.#.#.#......#....#..#.",
                "...##..#...#...#.##..#....#.#..",
                "...#.#.#.#.......#.......###..#",
                "...#..##..#####.#.....##.#..#..",
                ".......#.#.....#.....#...#...##",
                "#...#...#......##.#....##......",
                "#.....#.#.#.....#....#......#..",
                "..#..#.##.#......##..#.#..#..##",
                "####...#.....#....#.#..........",
                "....#.....###...#...##......#..",
                ".....#....#...#............#...",
                "...#...#..##.........#...#...##",
                "#.#..#.#...##.#.......#..#.#...",
                ".#.....#...##.............#...#",
                ".....#..##..#....#......#.##..#",
                "....#...###.................#..",
                "...###...#....#...#...#........",
                "....#.##.#.......#..#..........",
                "...#..#......#.#...###...#.#...",
                "..#.#..#...#.......#.......#.#.",
                ".#.#...#.#.##........#.........",
                "...#..#...#....#.#.#.#.#..###..",
                ".#..##......#.#.##..#.##....#..",
                "#....#.......##.....#.#........",
                "..###..#.#.#.......##....#.....",
                "........#.#.#....##...##..#....",
                "#....##.#....#...##..##...#....",
                "...#..##.#.....#...#.....##....",
                ".#.#..#..#...#....#..##.#....#.",
                "##.#.##....#.....#....#....#.#.",
                ".##......#............##...#...",
                "#..##.#.####.#.#....#..#..#.#.#",
                "#...##...#......##....###.....#",
                "..#.##.....#....#....#......#..",
                ".##.#...#.....#.#.#.#........##",
                ".#..#....#.#...........#...#...",
                "#.....#..#.....#.#.##.#.....#..",
                "....#.....#..#.#....###........",
                ".....###...........#.#..##.#.#.",
                "....###....#.......###..#...#.#",
                ".###.....#...##.#...##........#",
                "..#..#.#..#...#.#...#.#..#...#.",
                "#.####.......#....##.#..#.#..#.",
                "....#.#.##.#..###.........##.#.",
                "..#..#.#....#....#.##..........",
                "..##.###..#.#..#.#......#....#.",
                ".#..#.....##...#.#......##.#..#",
                "#.#....#..#.#.#........#.###...",
                "...#....##....##..###.###.#.#..",
                "..#....#.....#....##.#.........",
                "#.......#....#.........##..#...",
                ".#..#...#.#..#.#....#.#........",
                "...#..###...#.....#......##....",
                "..#...........#.....#..........",
                "....###.#...#......#...#..#....",
                ".....#.##..#..#....#.......#..#",
                "....##..#.#.#..............#.#.",
                ".#.#..#..#.#......#...#.#......",
                "....#.......#.##....##.#.#.#..#",
                "............#.#.#.....##.......",
                "........#...##.#..#......#...##",
                ".........#...#...#....#...#.##.",
                "..#.....#......#......#.....#..",
                "#....#...##..#.#....#.#...#.###",
                ".......#..#..#..#.#...#.....#.#",
                "...#.#...#......##.....#..#....",
                "...#.#.####..##.#..#...........",
                "..##..##....#.....####...#....#",
                "###.......#...##.#...#...#...#.",
                ".##..#.....#..####......#....#.",
                "#.....#..#..##..##...#..#..#...",
                ".#....#.....#...####..####.....",
                "..#....#...#......#........#.#.",
                "##.#.......#..#.....#..##..##..",
                ".#..#..#.#.#...#....##...#.##.#",
                "##...#..#....#.........##......"
            };

            var path = new PathFinderForFirstPuzzle(map);

            path.Traverse(x => x + 3, y => y + 1);
            Assert.Equal(169, path.Trees);
        }

        [Fact]
        public void CalculateSolutionForSecondPuzzle()
        {
            var map = new string[]
            {
                "..##.......",
                "#...#...#..",
                ".#....#..#.",
                "..#.#...#.#",
                ".#...##..#.",
                "..#.##.....",
                ".#.#.#....#",
                ".#........#",
                "#.##...#...",
                "#...##....#",
                ".#..#...#.#"
            };

            var paths = new (Func<int, int>, Func<int, int>)[]
            {
                (x => x + 3, y => y + 1),
                (x => x + 1, y => y + 1),
                (x => x + 5, y => y + 1),
                (x => x + 7, y => y + 1),
                (x => x + 1, y => y + 2)
            };

            var finder = new PathFinderForFirstPuzzle(map);
            var result = 1;

            foreach (var movements in paths)
            {
                finder.Traverse(movements.Item1, movements.Item2);
                result *= finder.Trees;
            }

            Assert.Equal(336, result);
        }

        [Fact]
        public void SolveSecondPuzzle()
        {
            var map = new string[]
            {
                "....#............#.###...#.#.#.",
                ".#.#....##.........#.....##.#..",
                ".#..#.#...####.##..#......#..##",
                "......#...#...#.......#........",
                "........#...###..#.#....#....#.",
                "..##.....#.....#.#.........#.#.",
                ".##.......#.#.#...#..#...##...#",
                "...##.....#....##....#...###.#.",
                "..#...#......##.#.##.....#.#..#",
                ".#....#.###.........#..........",
                ".#.#..##.....###.....###....#.#",
                "....###....#......#...#......##",
                "......##...#.##.........#.#..#.",
                "##.#....##...#..##....#.#..#.##",
                ".#...#..#.....#.#.......#...#..",
                "..........#..###.###......##..#",
                "..#.##.#..#......#.......###.#.",
                "...#...#.#.#..#...#.#..........",
                "#........#..#..#.#....#.##..###",
                "#...#.....#..####.........####.",
                ".....###..........#.#...##...#.",
                ".....#...#..#.......#....##.#..",
                "...........#..##.....#...#..#..",
                "......##..#........#...........",
                "#.#..#.#.#..#.....#....#.....#.",
                "..#....##....##...#.....#......",
                ".#.#....#..#.#......#..###...#.",
                ".......#...#.#....##..#..#..#..",
                ".#.#.#.......#....#.#.#.......#",
                ".#..........#.##.#...#..#.#.##.",
                "..#.#..........#.#....##.#.##..",
                "###..#..#.#...##.#.#..#........",
                "##....#...#....#....#...#.#....",
                "#...#.#....#.##..##...#.#......",
                "......#...#.###......##....#...",
                ".................#.###......#..",
                "##..#....#....##...###.#.#..###",
                "..#..........#..####..##..#...#",
                ".#......#..#.#...........##.#..",
                ".#..#......#...#.#.#..#.#.#.#.#",
                ".#......###.....#.#.#......##..",
                "#..........#.##...#...........#",
                "..#....#.##....#.........#.....",
                ".#..##....#...##.........#..#..",
                "....##..#.###..#.#...#..###..#.",
                "..#......#........#...#.#......",
                "........#..#..#..#...#.##......",
                ".##.#.#......#...#.........#...",
                "#..###.#...#....###.##..###....",
                "........##.............#....#..",
                "...#...............#....#.#....",
                "#..........#..#..#.#.....#...#.",
                ".#.............#...#.......#..#",
                ".#..#..#...#........##.........",
                ".....#.#..#.#..#..##.........#.",
                "..#..##...#....#.#...#.###..#..",
                "#...........##.....#...#.##....",
                "#.#.#.#........##......#...#.#.",
                "......#..#.###.#...#.##.##....#",
                ".#....#...#....#........#....#.",
                "..#.#..........#..##.......#..#", // 11
                ".....#...##..#................#",
                ".#...............##...#.##...##",
                "#.####....##.....#.......#.##..",
                "......#.##.#...##..###..#.#....",
                ".#.##.#...##..#.......#.#..#...",
                "#...#.##..........##..........#",
                "#.###...#...#..#.....#.#.##..##",
                ".##.....#....#...##.....##.....",
                "...#........#..###.###...#.....",
                "##..#....#.....#...#.#....#.#..",
                "#....#....#.#..........#...#..#",
                "...##..#......#..#..#..#..#....",
                ".....##...#..####..##.........#",
                ".....#..#.#...#..#....##..##...",
                "..#.......##.#..#.##...#.#....#",
                ".#..#.#...##..##....#..#......#",
                "..##.##..##...###..#....#...#..",
                "........##.......##...##.....##",
                ".#....###...#..#..#..#.......#.",
                "#.###............#....##.....#.",
                "..........#...#...##..#...#....",
                "..#......#.##.......#....##..##",
                "..#..###.....#...#.......#.....",
                "#.#...##.....#...#....#.......#",
                "....##.##.#....#.....#.#....#..",
                "...#....#.###............#..###",
                "#..##..#.........##.....#.#...#",
                "....#.......##......#....#...#.",
                "....#..##.#..........#.........",
                "....#...#.###.......#...#.#....",
                "#..#..#...#.......##...#..#.##.",
                "#.......#...##.##......#.......",
                "##..##...##...#......#...#...##",
                "..#...#.#.####.#...##.....##...",
                "#...#..#..#...##......#.#..#..#",
                "..##..##.#.#..#...####.....###.",
                ".#........#..##.###...#.##.#...",
                "........#..#...##......#.#....#",
                "..#...###.......##..##..#....#.",
                ".##...#.#..#.##.......##.###...",
                "#....#.#.#........#....#..#.##.",
                "....#.##.#.##..#.#####.....###.",
                "#.#..#..#...#.#..#.......#.#...",
                "....#...#....###...............",
                ".###.#.....#.#.......###......#",
                "##...#.#.###....##..#...##.....",
                "...#.#..#.###.#.......#...#.#..",
                ".#...#....#...#..####....###...",
                "..#....##.....##.#.#.##....#...",
                "#....#..##.......#...##.##....#",
                ".##..#.......#..#....###.......",
                "#.##.....##.#.........#......##",
                ".####.#...#.....#..#...#.##..#.",
                "....#...........#.....#........",
                ".#............##...#.......#.#.",
                "#....#.##........#....#.#..#..#",
                "#....#.##....#...##...#..#..#..",
                "...#..#.####.#....#............",
                "....#......#.........#.........",
                "#....##....###.....#......#.#..",
                "...#..#....#........###..#...#.",
                "..#.#........#.#.#.###..#.#.#..", // 19
                ".....###.....##.#....###.#.....",
                "##.#....#....##...##.###.#.##..",
                ".###.#..#.......##...#...##....",
                ".#...###........#.......##.##..",
                "#......####...#...##.#.######..",
                "....##.............#..##.##...#",
                "...........#..##.#...#.#.#...#.",
                "###.......#.##..#....#...#....#",
                ".........#.....#.#.#..##.#.....",
                "#...##..#....#..#.............#",
                "...#.......#.##.............#.#",
                ".....#..#...##......####..#....",
                ".#.#.#.....#...####..#...##...#",
                "#...#.#..#..#.#..#.##..........",
                ".....#.##..#.#.##..#.#.#....#.#",
                "...##..#...#...#..#....#.......",
                "........#.#..#...#...#.#...#...",
                "##..#........#..#.....#......##",
                ".........#..#...#......#......#",
                "..#.#.#........##...#.##.....##",
                ".###....##....#...#....#..#....",
                ".#.............###...#..##..###",
                ".##.##.##.......###.........#.#",
                "..#..###...#...#....#..#.#..#.#",
                "......#..#.#..#.....#.#........",
                "......#...####...#.#.....#.....",
                ".#...##.......#..#......#...#..",
                "#..#...#.......###..#..#.#.#.#.",
                ".....#.....###.##....#.#.##.#.#",
                "#........#....##...#..#.##..#..",
                "...#.#........##....#.#..###.#.",
                "#...#...##.........#........###",
                "##...#.##..##...#.....#.###.#..",
                "#.###.#.#..#...........##..#...",
                "........#.......#..#..#.###....",
                "#........#....#......###.......",
                "..#.###.######...#.###..#......",
                "...#...######..#.....#....#.#..",
                "..#.......#..#..#.........#...#",
                ".#...#..##.##.........##.......",
                ".........#.#.##.#..#....#.#...#",
                "#.......#....#......#.....###.#",
                "##..............#.###........#.",
                "..#.##..#.##.....#...#.#.#..###",
                "..#.#......#..#..##.#........#.",
                "..#.....#...#.#...#...###..#.#.",
                ".......#...........#..#..#.#.##",
                ".......#...##..#.###...........",
                ".#........#.###.#..#..#..#..#..",
                "##.#.##....#..###..#.##.##...#.",
                ".....#....##.#........#.#.#....",
                "....##....#..#..#....##....#.#.",
                "#.....##....#.....#.###.#....#.",
                ".#.##.##..#..#...#...........##",
                "...#..###..#.....##....#.......",
                "...#..##..###.#..#..#.#........",
                "......##..#.......#..##.....###",
                ".#...##.#.#.#......#...#.#.#.##",
                "....#.#....#...#........#...#..",
                "....#.#......#.#.###.#.#.##.#..",
                "#..#........###..#..#..#.....#.",
                "...#....#...##...#........##.##", // 33
                ".....#..#..#.....#....#.#...#..",
                "..#.###....#.#..##......#.##.#.",
                "..####......#..#.#.#..#.#####..",
                ".......##..#..###.#............",
                "..###.#........#..........##.##",
                "#.#.........#.##.#......#..#...",
                "...#.....#.....##..#..##.##..#.",
                "#.#.##....#.......###....##....",
                "...##.#..#...##.#..#......#..#.",
                "..##.........#.##.#####...#.#..",
                ".#....#...#....#.#.....##...###",
                "##.....#..####............###.#",
                "......#...........#....#.......",
                ".#......#.....##...........###.",
                "#......##.......#.#.#..##.....#",
                "...###.#.....##.#...#.#....#.#.",
                "...###.......#...#.............",
                "..#..#.#....#.#.###.#.#.##..##.",
                "..##...#..#.#..##.#.##....##...",
                "..#...........#..#....#....#...",
                "#.##...........#..#.#..##.#.#..",
                "...##...##................#..#.",
                ".#...#.##......#.#......#.####.",
                "#.##....#....#.........#....###",
                ".....###........#.#.#.##...#.##",
                ".....#....#.#....#.........#..#",
                "..#...#.#.#.#...#...#...##.#..#",
                "###.......#.....#.............#",
                "#.####.#.......#.#.#.#..#.#....",
                "#..#..#####......#....#..##....",
                "...............#.....#.#....###",
                ".###.....#...#.##..#.#..#.#####",
                "#.##.....#......##.......##....",
                "..........###.......#...#.#....",
                "..#.#..#...##.....#........#.#.",
                "........##.##....#####.#.#..##.",
                "..##.#.#...#####..........#.#.#",
                "#.........#......##...#.....#..",
                ".##.#........#...#..##...#...#.",
                ".......##..#...#.....#.##......",
                "....#.#...##..##..#....##......",
                "#........#..........##..####.#.",
                "...###...#.#.###.#...#....#.#.#",
                ".....##.#.....#........#.#....#",
                "#.......#....#...##..#......#..",
                "...#..........#.#.#...#.#.###.#",
                "....##.....#.##..#.#.#.........",
                "#.##..##..#....#.........#...#.",
                ".###..........#...##.#..#......",
                ".....####.............##...###.",
                ".#..#....#..#...#..#...........",
                "#..#..##..#...#.##..#.###.#...#",
                "......#.#..###...#..#.....#..#.",
                "##.##......#...#.#...#.........",
                "....##.#.......#.#..##....#.#.#",
                "#..##..#...###.#....##.........",
                ".............#.#....#...##..#..",
                "..#....#...#.....#.##.#..##..##",
                "##.#..##.#..##.#.#.##.#...#.#..",
                ".##.#..#.#........##.#...##....",
                "#.........##....##..#......#...",
                ".#.#.......##...#..#......###.#", // 42
                "........#.#.#.#......#....#..#.",
                "...##..#...#...#.##..#....#.#..",
                "...#.#.#.#.......#.......###..#",
                "...#..##..#####.#.....##.#..#..",
                ".......#.#.....#.....#...#...##",
                "#...#...#......##.#....##......",
                "#.....#.#.#.....#....#......#..",
                "..#..#.##.#......##..#.#..#..##",
                "####...#.....#....#.#..........",
                "....#.....###...#...##......#..",
                ".....#....#...#............#...",
                "...#...#..##.........#...#...##",
                "#.#..#.#...##.#.......#..#.#...",
                ".#.....#...##.............#...#",
                ".....#..##..#....#......#.##..#",
                "....#...###.................#..",
                "...###...#....#...#...#........",
                "....#.##.#.......#..#..........",
                "...#..#......#.#...###...#.#...",
                "..#.#..#...#.......#.......#.#.",
                ".#.#...#.#.##........#.........",
                "...#..#...#....#.#.#.#.#..###..",
                ".#..##......#.#.##..#.##....#..",
                "#....#.......##.....#.#........",
                "..###..#.#.#.......##....#.....",
                "........#.#.#....##...##..#....",
                "#....##.#....#...##..##...#....",
                "...#..##.#.....#...#.....##....",
                ".#.#..#..#...#....#..##.#....#.",
                "##.#.##....#.....#....#....#.#.",
                ".##......#............##...#...",
                "#..##.#.####.#.#....#..#..#.#.#",
                "#...##...#......##....###.....#",
                "..#.##.....#....#....#......#..",
                ".##.#...#.....#.#.#.#........##",
                ".#..#....#.#...........#...#...",
                "#.....#..#.....#.#.##.#.....#..",
                "....#.....#..#.#....###........",
                ".....###...........#.#..##.#.#.",
                "....###....#.......###..#...#.#",
                ".###.....#...##.#...##........#",
                "..#..#.#..#...#.#...#.#..#...#.",
                "#.####.......#....##.#..#.#..#.",
                "....#.#.##.#..###.........##.#.",
                "..#..#.#....#....#.##..........",
                "..##.###..#.#..#.#......#....#.",
                ".#..#.....##...#.#......##.#..#",
                "#.#....#..#.#.#........#.###...",
                "...#....##....##..###.###.#.#..",
                "..#....#.....#....##.#.........",
                "#.......#....#.........##..#...",
                ".#..#...#.#..#.#....#.#........",
                "...#..###...#.....#......##....",
                "..#...........#.....#..........",
                "....###.#...#......#...#..#....",
                ".....#.##..#..#....#.......#..#",
                "....##..#.#.#..............#.#.",
                ".#.#..#..#.#......#...#.#......",
                "....#.......#.##....##.#.#.#..#",
                "............#.#.#.....##.......",
                "........#...##.#..#......#...##",
                ".........#...#...#....#...#.##.", // 51
                "..#.....#......#......#.....#..",
                "#....#...##..#.#....#.#...#.###",
                ".......#..#..#..#.#...#.....#.#",
                "...#.#...#......##.....#..#....",
                "...#.#.####..##.#..#...........",
                "..##..##....#.....####...#....#",
                "###.......#...##.#...#...#...#.",
                ".##..#.....#..####......#....#.",
                "#.....#..#..##..##...#..#..#...",
                ".#....#.....#...####..####.....",
                "..#....#...#......#........#.#.",
                "##.#.......#..#.....#..##..##..",
                ".#..#..#.#.#...#....##...#.##.#",
                "##...#..#....#.........##......" // 53
            };

            var paths = new (Func<int, int>, Func<int, int>)[]
            {
                (x => x + 3, y => y + 1),
                (x => x + 1, y => y + 1),
                (x => x + 5, y => y + 1),
                (x => x + 7, y => y + 1),
                (x => x + 1, y => y + 2)
            };

            var finder = new PathFinderForFirstPuzzle(map);
            var result = 1L;

            foreach (var movements in paths)
            {
                finder.Traverse(movements.Item1, movements.Item2);
                result *= finder.Trees;
            }

            Assert.Equal(7560370818, result);
        }
    }

    public class PathFinderForFirstPuzzle
    {
        private readonly string[] _map;

        public int Trees { get; private set; }

        public PathFinderForFirstPuzzle(string[] map) =>
            _map = map;

        public void Traverse(Func<int, int> moveX, Func<int, int> moveY)
        {
            var x = 0;
            Trees = 0;

            for (var y = moveY(0); y < _map.Length; y = moveY(y))
            {
                x = moveX(x) % _map[0].Length;
                if (_map[y][x] != '.')
                {
                    Trees++;
                }
            }
        }
    }
}
